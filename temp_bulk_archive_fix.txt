// Función corregida para archivar en lote
const bulkArchive = async (archive: boolean) => {
    const supabase = createClient()
    const leadIds = Array.from(selectedLeads)
    
    try {
        // Actualizar cada lead individualmente
        const updates = leadIds.map(leadId =>
            supabase
                .from('leads')
                .update({ archived: archive })
                .eq('id', leadId)
        )

        const results = await Promise.all(updates)
        
        // Verificar si hubo errores
        const errors = results.filter(r => r.error)
        
        if (errors.length > 0) {
            console.error('Error bulk archiving:', errors)
            toast.error(`Error al archivar ${errors.length} conversación(es)`)
        } else {
            toast.success(`${selectedLeads.size} conversación(es) ${archive ? 'archivada(s)' : 'desarchivada(s)'}`)\n            clearSelection()
        }
    } catch (err) {
        console.error('Exception bulk archiving:', err)
        toast.error('Error inesperado')
    }
}
